---

- hosts: localhost
  tasks:
  - pause:
      prompt: "Are you sure you want to delete the '{{ env_id }}' cluster (yes/no)"
    register: delete_cluster
  - name: "Error out unless user confirms deletion of cluster"
    fail:
      msg: "Abort task: delete '{{ env_id }}' cluster"
    when:
      - not delete_cluster.user_input | default('no') | bool

- hosts: localhost
  pre_tasks:
    - import_tasks: ../prep-inventory.yml
  roles:
    - role: ../../../galaxy/openshift-ansible-contrib/roles/openstack-stack
      stack_name: "{{ full_dns_domain }}"
      stack_state: 'absent'
  post_tasks:
    - name: Delete auto provisioned registry
      os_volume:
        display_name: "{{ full_dns_domain }}-registry"
        state: 'absent'
